<!DOCTYPE html>
<html lang="cs">

<head>
  <meta charset="UTF-8">
  <title>Ping-Pong Turnaj</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;

      background-image: url('background.jpg');
      background-size: cover;
      /* roztáhne na celou obrazovku */
      background-repeat: no-repeat;
      /* nezopakuje */
      background-position: center center;
      /* zarovná na střed */
      background-attachment: fixed;
      /* pozadí se neposouvá při scrollování */

      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }


    h1 {
      margin-top: 20px;
      font-size: 2.5rem;
      color: #006064;
    }

    .menu {
      display: flex;
      gap: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 50px 40px;
      font-size: 1.5rem;
      border: none;
      border-radius: 10px;
      background-color: #0097a7;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }

    .btn:hover {
      background-color: #006064;
    }

    .btn1 {
      padding: 10px 100px;
      font-size: 1.5rem;
      border: none;
      border-radius: 10px;
      background-color: #0097a7;
      color: white;
      cursor: pointer;
      opacity: 0.01;
      transition: background 0.3s;
    }

    .section {
      display: none;
      flex-direction: column;
      align-items: center;
      width: 90%;
      max-width: 600px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }

    .form-group {
      margin: 15px 0;
      width: 100%;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    input,
    select {
      width: 80%;
      padding: 15px;
      font-size: 1.2rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .score-inputs {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      
    }

    .score-inputs input {
      width: 100%;
    }

    .back-btn {
      margin-top: 20px;
      background-color: #ef5350;
    }

   /* .vysledky {
      background-color: rgb(120, 172, 202);
      /* nebo jiná barva, např. #f0f0f0 */
     /* opacity: 0.8;
      /* zajistí, že nebude průhledná */
   /*   font-size: 28px;
    }

    .vysledky th,
    .vysledky td {
      background-color: inherit;
      /* aby buňky měly stejné pozadí jako celá tabulka */
   /*}*/

    .turnaj-tabulka {
      width: 100%;
      border-collapse: collapse;
      background: linear-gradient(to right, #f8f9fa, #e9ecef);
      font-family: sans-serif;
      border: none;
    }
  
    .turnaj-tabulka th, .turnaj-tabulka td {
      text-align: left;
      padding: 12px;
      border: none;
    }
  
    .turnaj-tabulka th {
      background-color: #343a40;
      color: rgb(190, 177, 177);
    }
  
    .turnaj-tabulka tr:nth-child(even) {
      background-color: rgb(190, 177, 177);
    }
  
    .turnaj-tabulka tr:hover {
      background-color: #ddd;
    }
  </style>

  </style>
</head>

<body onload="load();">

  <div class="menu">
    <button class="btn" onclick="zobraz('registrace')">Registrace hráče</button>
    <button class="btn" onclick="zobraz('skupinaA')">Zápas - Skupina skupinaA</button>
    <button class="btn" onclick="zobraz('skupinaB')">Zápas - Skupina skupinaB</button>
  </div>
  
  <!-- Sekce: Registrace -->
  <div id="registrace" class="section">
    <h2>Registrace hráče</h2>
    <div class="form-group">
      <label>Jméno:</label>
      <input type="text" inputmode="text" onclick="input(this)"  id="jmeno">
    </div>
    <div class="form-group">
      <label>Příjmení:</label>
      <input type="text" inputmode="text" onclick="input(this)"  id="prijmeni">
    </div>
    <div class="form-group">
      <label>Skupina:</label>
      <select id="skupina">
        <option>skupinaA</option>
        <option>skupinaB</option>
      </select>
    </div>
    <button class="btn" onclick="ulozHrace()">Uložit hráče</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <!-- Sekce: Zápasy -->
  <div id="skupinaA" class="section">
    <h2>Zápas - Skupina skupinaA</h2>
    <div class="form-group">
      <label>Hráč 1:</label>
      <select id="hrac1A"></select>
    </div>
    <div class="form-group">
      <label>Hráč 2:</label>
      <select id="hrac2A"></select>
    </div>
    <div class="form-group score-inputs">
      <input type="number" inputmode="number" onclick="input(this)" id="skore1A" placeholder="Skóre hráče 1">
      <input type="number" inputmode="number" onclick="input(this)" id="skore2A" placeholder="Skóre hráče 2">
    </div>
    <button class="btn" onclick="ulozZapas('skupinaA')">Uložit zápas</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <div id="skupinaB" class="section">
    <h2>Zápas - Skupina skupinaB</h2>
    <div class="form-group">
      <label>Hráč 1:</label>
      <select id="hrac1B"></select>
    </div>
    <div class="form-group">
      <label>Hráč 2:</label>
      <select id="hrac2B"></select>
    </div>
    <div class="form-group score-inputs">
      <input type="number" inputmode="number" onclick="input(this)" id="skore1B" placeholder="Skóre hráče 1">
      <input type="number" inputmode="number" onclick="input(this)" id="skore2B" placeholder="Skóre hráče 2">
    </div>
    <button class="btn" onclick="ulozZapas('skupinaB')">Uložit zápas</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <h1>Ping-pong Turnaj</h1>
  <button class="btn1" id="btnVysledky" onclick="toggleVysledky()">Zobrazit výsledky</button>

  <div id="vysledky" style="display: none; padding: 2rem;">
    <h2>Výsledky Skupiny skupinaA</h2>
    <table id="tabulkaA" class="turnaj-tabulka"  border="0"></table>

    <h2>Výsledky Skupiny skupinaB</h2>
    <table id="tabulkaB" class="turnaj-tabulka" border="0"></table>
  </div>

  <div id="zpravaUlozeno" style="
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #4caf50;
  color: white;
  padding: 60px 80px;
  border-radius: 10px;
  font-size: 32px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  z-index: 1000;
">
  Zápas uložen!
</div>

  <script>

    if ("virtualKeyboard" in navigator) {
      navigator.virtualKeyboard.overlaysContent = true;
    
      navigator.virtualKeyboard.addEventListener("geometrychange", (event) => {
        const { x, y, width, height } = event.target.boundingRect;
      });
    }


    function ulozHrace() {
      const jmeno = document.getElementById('jmeno').value.trim();
      const prijmeni = document.getElementById('prijmeni').value.trim();
      const skupina = document.getElementById('skupina').value;
      if (!jmeno || !prijmeni) return zobrazZpravu('Vyplňte jméno i příjmení!',true);//alert('Vyplňte jméno i příjmení');
  
      let hraci = JSON.parse(localStorage.getItem('hraci') || '[]');
      hraci.push({ jmeno, prijmeni, skupina });
      localStorage.setItem('hraci', JSON.stringify(hraci));
      //alert('Hráč uložen!');
      document.getElementById('jmeno').value = '';
      document.getElementById('prijmeni').value = '';
      naplnCombo('A');
      naplnCombo('B');
      zobrazZpravu('Hráč uložen!');
    }
  
    function naplnCombo(skupina) {
      let hraci = JSON.parse(localStorage.getItem('hraci') || '[]');
      const combo1 = document.getElementById('hrac1' + skupina);
      const combo2 = document.getElementById('hrac2' + skupina);
  
      // vyčistit comboboxy
      combo1.innerHTML = '';
      combo2.innerHTML = '';
  
      hraci.filter(h => h.skupina === 'skupina' + skupina).forEach(h => {
        const celeJmeno = h.jmeno + ' ' + h.prijmeni;
        let opt1 = document.createElement('option');
        opt1.textContent = celeJmeno;
        combo1.appendChild(opt1);
  
        let opt2 = document.createElement('option');
        opt2.textContent = celeJmeno;
        combo2.appendChild(opt2);
      });
    }

    function ulozZapas(skupina) {
      const id1 = skupina === 'skupinaA' ? 'A' : 'B';
      const h1Select = document.getElementById('hrac1' + id1);
      const h2Select = document.getElementById('hrac2' + id1);
      const s1Input = document.getElementById('skore1' + id1);
      const s2Input = document.getElementById('skore2' + id1);
    
      const h1 = h1Select.value;
      const h2 = h2Select.value;
      const s1 = s1Input.value;
      const s2 = s2Input.value;
    
      if (!h1 || !h2 || h1 === h2) return zobrazZpravu('Zvolte dva různé hráče!',true);//alert('');
      if (s1 === '' || s2 === '') return zobrazZpravu('Zadejte skóre!',true);//alert('Zadejte skóre');
    
      let zapasy = JSON.parse(localStorage.getItem('zapasy') || '[]');
      zapasy.push({ h1, h2, s1, s2, skupina: id1 });
      localStorage.setItem('zapasy', JSON.stringify(zapasy));
    
      // Reset ComboBoxů a skóre
      h1Select.value = '';
      h2Select.value = '';
      s1Input.value = '';
      s2Input.value = '';
        // Zobraz info
      zobrazZpravu('Zápas uložen!');
    }

    function zobrazZpravu(text, jeChyba = false) {
      const div = document.getElementById('zpravaUlozeno');
      div.textContent = text;
      div.style.backgroundColor = jeChyba ? '#f44336' : '#4caf50'; // červená nebo zelená
      div.style.display = 'block';
    
      setTimeout(() => {
        div.style.display = 'none';
      }, 2000);
    }


    
  
    // Při načtení stránky naplníme comboboxy
    window.onload = () => {
      naplnCombo('A');
      naplnCombo('B');
    };
  </script>
  
  <script>
    function toggleVysledky() {
      const vysledkyDiv = document.getElementById("vysledky");
      const tlacitko = document.getElementById("btnVysledky");

      if (vysledkyDiv.style.display === "block") {
        vysledkyDiv.style.display = "none";
        tlacitko.textContent = "Zobrazit výsledky";
      } else {
        zobrazVysledky();
        vysledkyDiv.style.display = "block";
        tlacitko.textContent = "Skrýt výsledky";
      }
    }

    function zobrazVysledky() {
      const zapasy = JSON.parse(localStorage.getItem('zapasy') || '[]');
      const statistikyA = {};
      const statistikyB = {};

      for (const z of zapasy) {
        const [cele1, cele2] = [z.h1, z.h2];
        const s1 = parseInt(z.s1) || 0;
        const s2 = parseInt(z.s2) || 0;

        const data1 = { jmeno: cele1, vyhry: 0, prohry: 0, body: s1 };
        const data2 = { jmeno: cele2, vyhry: 0, prohry: 0, body: s2 };

        if (s1 > s2) { data1.vyhry++; data2.prohry++; }
        else if (s2 > s1) { data2.vyhry++; data1.prohry++; }

        const stat = z.skupina === "A" ? statistikyA : statistikyB;
        stat[cele1] = merge(stat[cele1], data1);
        stat[cele2] = merge(stat[cele2], data2);
      }

      vykresliTabulku("tabulkaA", statistikyA);
      vykresliTabulku("tabulkaB", statistikyB);
    }


    function merge(puvodni, nove) {
      if (!puvodni) return { ...nove };
      return {
        jmeno: nove.jmeno,
        vyhry: puvodni.vyhry + nove.vyhry,
        prohry: puvodni.prohry + nove.prohry,
        body: puvodni.body + nove.body
      };
    }

  /*  function vykresliTabulku(id, data) {
      const tbody = Object.values(data)
        .sort((a, b) => b.vyhry - a.vyhry || b.body - a.body); // seřazení podle výher, pak bodů

      let html = "<tr><th>Pořadí</th><th>Hráč</th><th>Výhry</th><th>Prohry</th><th>Body</th></tr>";
      tbody.forEach((hrac, index) => {
        html += `<tr>
          <td>${index + 1}</td>
          <td>${hrac.jmeno}</td>
          <td>${hrac.vyhry}</td>
          <td>${hrac.prohry}</td>
          <td>${hrac.body}</td>
        </tr>`;
      });
      document.getElementById(id).innerHTML = html;
    }*/

    function vykresliTabulku(id, data) {
      const tbody = Object.values(data)
        .sort((a, b) => b.vyhry - a.vyhry || b.body - a.body); // seřazení podle výher, pak bodů
    
      let html = `<table class="turnaj-tabulka">
        <tr><th>Pořadí</th><th>Hráč</th><th>Výhry</th><th>Prohry</th><th>Body</th></tr>`;
    
      tbody.forEach((hrac, index) => {
        html += `<tr>
          <td>${index + 1}</td>
          <td>${hrac.jmeno}</td>
          <td>${hrac.vyhry}</td>
          <td>${hrac.prohry}</td>
          <td>${hrac.body}</td>
        </tr>`;
      });
    
      html += `</table>`;
      document.getElementById(id).innerHTML = html;
    }


    function merge(puvodni, nove) {
      if (!puvodni) return { ...nove };
      return {
        jmeno: nove.jmeno,
        vyhry: puvodni.vyhry + nove.vyhry,
        prohry: puvodni.prohry + nove.prohry,
        body: puvodni.body + nove.body
      };
    }

    function vykresliTabulku(id, data) {
      const tbody = Object.values(data)
        .sort((a, b) => b.vyhry - a.vyhry || b.body - a.body); // seřazení podle výher, pak bodů

      let html = "<tr><th>Pořadí</th><th>Hráč</th><th>Výhry</th><th>Prohry</th><th>Body</th></tr>";
      tbody.forEach((hrac, index) => {
        html += `<tr>
          <td>${index + 1}</td>
          <td>${hrac.jmeno}</td>
          <td>${hrac.vyhry}</td>
          <td>${hrac.prohry}</td>
          <td>${hrac.body}</td>
        </tr>`;
      });
      document.getElementById(id).innerHTML = html;
    }

    function zobraz(id) {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
      document.getElementById(id).style.display = 'flex';
      if (id === 'A' || id === 'B') naplnCombo(id.slice(-1));
    }

    function zpet() {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
    }

  </script>

</body>

</html>