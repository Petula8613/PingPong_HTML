<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Ping-Pong Turnaj</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>

html, body {
  height: 100%;
  margin: 0;
  font-family: 'Segoe UI', sans-serif;

  background-image: url('background.jpg');
  background-size: cover;        /* roztáhne na celou obrazovku */
  background-repeat: no-repeat;  /* nezopakuje */
  background-position: center center; /* zarovná na střed */
  background-attachment: fixed;  /* pozadí se neposouvá při scrollování */

  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}


    h1 {
      margin-top: 20px;
      font-size: 2.5rem;
      color: #006064;
    }

    .menu {
      display: flex;
      gap: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 50px 100px;
      font-size: 1.5rem;
      border: none;
      border-radius: 10px;
      background-color: #0097a7;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }

    .btn:hover {
      background-color: #006064;
    }
    .btn1 {
      padding: 10px 100px;
      font-size: 1.5rem;
      border: none;
      border-radius: 10px;
      background-color: #0097a7;
      color: white;
      cursor: pointer;
      opacity: 0.01;
      transition: background 0.3s;
    }

    .section {
      display: none;
      flex-direction: column;
      align-items: center;
      width: 90%;
      max-width: 600px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }

    .form-group {
      margin: 15px 0;
      width: 100%;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }

    input, select {
      width: 80%;
      padding: 15px;
      font-size: 1.2rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .score-inputs {
      display: flex;
      justify-content: space-between;
      gap: 20px;
    }

    .score-inputs input {
      width: 100%;
    }

    .back-btn {
      margin-top: 20px;
      background-color: #ef5350;
    }

  .vysledky {
    background-color: rgb(120, 172, 202); /* nebo jiná barva, např. #f0f0f0 */
    opacity: 0.8; /* zajistí, že nebude průhledná */
    font-size: 28px;
  }

  .vysledky th, .vysledky td {
    background-color: inherit; /* aby buňky měly stejné pozadí jako celá tabulka */
  }
</style>

  </style>
</head>
<body>

  <div class="menu">
    <button class="btn" onclick="zobraz('registrace')">Registrace hráče</button>
    <button class="btn" onclick="zobraz('Dospělí')">Zápas - Skupina Dospělí</button>
    <button class="btn" onclick="zobraz('Děti')">Zápas - Skupina Děti</button>
  </div>

  <!-- Sekce: Registrace -->
  <div id="registrace" class="section">
    <h2>Registrace hráče</h2>
    <div class="form-group">
      <label>Jméno:</label>
      <input type="text" id="jmeno">
    </div>
    <div class="form-group">
      <label>Příjmení:</label>
      <input type="text" id="prijmeni">
    </div>
    <div class="form-group">
      <label>Skupina:</label>
      <select id="skupina">
        <option>Dospělí</option>
        <option>Děti</option>
      </select>
    </div>
    <button class="btn" onclick="ulozHrace()">Uložit hráče</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <!-- Sekce: Zápasy -->
  <div id="Dospělí" class="section">
    <h2>Zápas - Skupina Dospělí</h2>
    <div class="form-group">
      <label>Hráč 1:</label>
      <select id="hrac1A"></select>
    </div>
    <div class="form-group">
      <label>Hráč 2:</label>
      <select id="hrac2A"></select>
    </div>
    <div class="form-group score-inputs">
      <input type="number" id="skore1A" placeholder="Skóre hráče 1">
      <input type="number" id="skore2A" placeholder="Skóre hráče 2">
    </div>
    <button class="btn" onclick="ulozZapas('Dospělí')">Uložit zápas</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <div id="Děti" class="section">
    <h2>Zápas - Skupina Děti</h2>
    <div class="form-group">
      <label>Hráč 1:</label>
      <select id="hrac1B"></select>
    </div>
    <div class="form-group">
      <label>Hráč 2:</label>
      <select id="hrac2B"></select>
    </div>
    <div class="form-group score-inputs">
      <input type="number" id="skore1B" placeholder="Skóre hráče 1">
      <input type="number" id="skore2B" placeholder="Skóre hráče 2">
    </div>
    <button class="btn" onclick="ulozZapas('Děti')">Uložit zápas</button>
    <button class="btn back-btn" onclick="zpet()">Zpět</button>
  </div>

  <h1>Ping-pong Turnaj</h1>  
  <button class="btn1" id="btnVysledky" onclick="toggleVysledky()">Zobrazit výsledky</button>


  <div id="vysledky" style="display: none; padding: 2rem;">
    <h2>Výsledky Skupiny Dospělí</h2>
    <table id="tabulkaA" class="vysledky" border="1"></table>
  
    <h2>Výsledky Skupiny Děti</h2>
    <table id="tabulkaB" class="vysledky" border="1"></table>
  </div>
  <script>
    function toggleVysledky() {
      const vysledkyDiv = document.getElementById("vysledky");
      const tlacitko = document.getElementById("btnVysledky");

      if (vysledkyDiv.style.display === "block") {
        vysledkyDiv.style.display = "none";
        tlacitko.textContent = "Zobrazit výsledky";
      } else {
        zobrazVysledky();
        vysledkyDiv.style.display = "block";
        tlacitko.textContent = "Skrýt výsledky";
      }
    }

    function zobrazVysledky() {
      const zapasy = JSON.parse(localStorage.getItem('zapasy') || '[]');
      const statistikyA = {};
      const statistikyB = {};

      for (const z of zapasy) {
        const [cele1, cele2] = [z.h1, z.h2];
        const s1 = parseInt(z.s1) || 0;
        const s2 = parseInt(z.s2) || 0;

        const data1 = { jmeno: cele1, vyhry: 0, prohry: 0, body: s1 };
        const data2 = { jmeno: cele2, vyhry: 0, prohry: 0, body: s2 };

        if (s1 > s2) { data1.vyhry++; data2.prohry++; }
        else if (s2 > s1) { data2.vyhry++; data1.prohry++; }

        const stat = z.skupina === "A" ? statistikyA : statistikyB;
        stat[cele1] = merge(stat[cele1], data1);
        stat[cele2] = merge(stat[cele2], data2);
      }

      vykresliTabulku("tabulkaA", statistikyA);
      vykresliTabulku("tabulkaB", statistikyB);
    }


    function merge(puvodni, nove) {
      if (!puvodni) return { ...nove };
      return {
        jmeno: nove.jmeno,
        vyhry: puvodni.vyhry + nove.vyhry,
        prohry: puvodni.prohry + nove.prohry,
        body: puvodni.body + nove.body
      };
    }

    function vykresliTabulku(id, data) {
      const tbody = Object.values(data)
        .sort((a, b) => b.vyhry - a.vyhry || b.body - a.body); // seřazení podle výher, pak bodů

      let html = "<tr><th>Pořadí</th><th>Hráč</th><th>Výhry</th><th>Prohry</th><th>Body</th></tr>";
      tbody.forEach((hrac, index) => {
        html += `<tr>
          <td>${index + 1}</td>
          <td>${hrac.jmeno}</td>
          <td>${hrac.vyhry}</td>
          <td>${hrac.prohry}</td>
          <td>${hrac.body}</td>
        </tr>`;
      });
      document.getElementById(id).innerHTML = html;
    }


    function merge(puvodni, nove) {
      if (!puvodni) return { ...nove };
      return {
        jmeno: nove.jmeno,
        vyhry: puvodni.vyhry + nove.vyhry,
        prohry: puvodni.prohry + nove.prohry,
        body: puvodni.body + nove.body
      };
    }

    function vykresliTabulku(id, data) {
      const tbody = Object.values(data)
        .sort((a, b) => b.vyhry - a.vyhry || b.body - a.body); // seřazení podle výher, pak bodů

      let html = "<tr><th>Pořadí</th><th>Hráč</th><th>Výhry</th><th>Prohry</th><th>Body</th></tr>";
      tbody.forEach((hrac, index) => {
        html += `<tr>
          <td>${index + 1}</td>
          <td>${hrac.jmeno}</td>
          <td>${hrac.vyhry}</td>
          <td>${hrac.prohry}</td>
          <td>${hrac.body}</td>
        </tr>`;
      });
      document.getElementById(id).innerHTML = html;
    }

    function zobraz(id) {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
      document.getElementById(id).style.display = 'flex';
      if (id === 'Dospělí' || id === 'Děti') naplnCombo(id.slice(-1));
    }

    function zpet() {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
    }

    function ulozHrace() {
      const jmeno = document.getElementById('jmeno').value.trim();
      const prijmeni = document.getElementById('prijmeni').value.trim();
      const skupina = document.getElementById('skupina').value;
      if (!jmeno || !prijmeni) return alert('Vyplňte jméno i příjmení');

      let hraci = JSON.parse(localStorage.getItem('hraci') || '[]');
      hraci.push({ jmeno, prijmeni, skupina });
      localStorage.setItem('hraci', JSON.stringify(hraci));
      alert('Hráč uložen.');
      document.getElementById('jmeno').value = '';
      document.getElementById('prijmeni').value = '';
    }

    function naplnCombo(skupina) {
      // Get the players from localStorage and filter by the selected group (A or B)
      const hraci = JSON.parse(localStorage.getItem('hraci') || '[]').filter(h => h.skupina === skupina);

      // Get the ComboBoxes for player 1 and player 2
      const combo1 = document.getElementById(`hrac1${skupina}`);
      const combo2 = document.getElementById(`hrac2${skupina}`);

      // Clear existing options in both ComboBoxes
      combo1.innerHTML = '';
      combo2.innerHTML = '';

      // Add a default "Select" option to both ComboBoxes
      combo1.appendChild(new Option("Vyber hráče", ""));
      combo2.appendChild(new Option("Vyber hráče", ""));

      // If there are players in the selected group, populate the ComboBoxes
      if (hraci.length > 0) {
        hraci.forEach(h => {
          const option = new Option(`${h.jmeno} ${h.prijmeni}`, `${h.jmeno} ${h.prijmeni}`);
          combo1.appendChild(option.cloneNode(true));
          combo2.appendChild(option.cloneNode(true));
        });
      } else {
        alert(`V skupině ${skupina} nejsou žádní hráči.`);
      }
    }


    function ulozZapas(skupina) {
      const h1 = document.getElementById(`hrac1${skupina}`).value;
      const h2 = document.getElementById(`hrac2${skupina}`).value;
      const s1 = document.getElementById(`skore1${skupina}`).value;
      const s2 = document.getElementById(`skore2${skupina}`).value;
      if (!h1 || !h2 || h1 === h2) return alert('Vyber různé hráče.');

      let zapasy = JSON.parse(localStorage.getItem('zapasy') || '[]');
      zapasy.push({ h1, h2, s1, s2, skupina });
      localStorage.setItem('zapasy', JSON.stringify(zapasy));
      alert('Zápas uložen.');
    }
  </script>

</body>
</html>
